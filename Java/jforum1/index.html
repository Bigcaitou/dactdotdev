<!doctype html><html class="h-full w-full font-sans" lang=zh-cn><head><meta charset=utf-8><link rel="shortcut icon" href=http://example.org/favicon.ico type=image/x-icon><meta name=viewport content="width=device-width,initial-scale=1"><title>- My New Hugo Site</title><meta property="og:title" content><meta property="og:description" content="[TOC]
jforum二次开发相关笔记 1. 引言 jforum是Rafael Steil开发的一个基于JAVA的开源论坛，采用BSD开源协议，可以最大限度的进行任何修改和扩展，包括商业用途。它提供了诸如SSO之类的抽象接口，具有完全的权限控制、支持包括中文在内的十几种语言、可自定义的用户接口、安全、多数据库支持等特性。JForum 采用 FreeMarker作为页面模板引擎。jforum的介绍这里不再敷述，因项目需要，需要对jforum进行修改、实现从CS平台登录以后单点登录到jforum，因为jforum只支持唯一用户名标识，所以还需对jforum进行二次开发。(注：本文的jforum版本为2.1.9。)
2. jforum的页面请求机制 将jforum导入到eclipse可以参考《Java开源论坛JForum二次开发技术资料之导入安装》。以最简单的在一个登陆用户进入 个人资料页为例：
2.1 处理url 用户点击 个人资料，页面请求的url为/user/edit/session中获取的用户Id如header.htm源码所示： /jforum/WebContent/templates/default/header.htm
<a id=&#34;myprofile&#34; class=&#34;mainmenu&#34; href=&#34;${JForumContext.encodeURL(&#34;/user/edit/${session.userId}&#34;)}&#34;> <img src=&#34;${contextPath}/templates/${templateName}/images/icon_mini_profile.gif&#34; border=&#34;0&#34; alt=&#34;[Profile]&#34; /> ${I18n.getMessage(&#34;ForumBase.profile&#34;)} JForum中的JForumContext.encodeURL方法（注：实现在/jforum/src/net/jforum/context/JForumContext.java下）根据请求的url中的 user和 edit在modulesMapping.properties中查询user对应的配置项:
/jforum/WebContent/WEB-INF/config/modulesMapping.properties
user=net.jforum.view.forum.UserAction 2.2 查询action 根据请求的url中的 edit`在相应的UserAction中找到edit方法：
/jforum/src/net/jforum/view/forum/UserAction.java
public void edit() { if (this.canEdit()) { int userId = this.request.getIntParameter(&#34;user_id&#34;); UserDAO um = DataAccessDriver.getInstance().newUserDAO(); User u = um.selectById(userId); this.context.put(&#34;u&#34;, u); this.context.put(&#34;action&#34;, &#34;editSave&#34;); this.context.put(&#34;pageTitle&#34;, I18n.getMessage(&#34;UserProfile.profileFor&#34;) + &#34; &#34; +u.getUsername()); this.context.put(&#34;avatarAllowExternalUrl&#34;, SystemGlobals.getBoolValue(ConfigKeys.AVATAR_ALLOW_EXTERNAL_URL)); this.setTemplateName(TemplateKeys.USER_EDIT); } } 2."><meta property="og:type" content="article"><meta property="og:url" content="http://example.org/java/jforum1/"><meta property="article:section" content="Java"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="[TOC]
jforum二次开发相关笔记 1. 引言 jforum是Rafael Steil开发的一个基于JAVA的开源论坛，采用BSD开源协议，可以最大限度的进行任何修改和扩展，包括商业用途。它提供了诸如SSO之类的抽象接口，具有完全的权限控制、支持包括中文在内的十几种语言、可自定义的用户接口、安全、多数据库支持等特性。JForum 采用 FreeMarker作为页面模板引擎。jforum的介绍这里不再敷述，因项目需要，需要对jforum进行修改、实现从CS平台登录以后单点登录到jforum，因为jforum只支持唯一用户名标识，所以还需对jforum进行二次开发。(注：本文的jforum版本为2.1.9。)
2. jforum的页面请求机制 将jforum导入到eclipse可以参考《Java开源论坛JForum二次开发技术资料之导入安装》。以最简单的在一个登陆用户进入 个人资料页为例：
2.1 处理url 用户点击 个人资料，页面请求的url为/user/edit/session中获取的用户Id如header.htm源码所示： /jforum/WebContent/templates/default/header.htm
<a id=&#34;myprofile&#34; class=&#34;mainmenu&#34; href=&#34;${JForumContext.encodeURL(&#34;/user/edit/${session.userId}&#34;)}&#34;> <img src=&#34;${contextPath}/templates/${templateName}/images/icon_mini_profile.gif&#34; border=&#34;0&#34; alt=&#34;[Profile]&#34; /> ${I18n.getMessage(&#34;ForumBase.profile&#34;)} JForum中的JForumContext.encodeURL方法（注：实现在/jforum/src/net/jforum/context/JForumContext.java下）根据请求的url中的 user和 edit在modulesMapping.properties中查询user对应的配置项:
/jforum/WebContent/WEB-INF/config/modulesMapping.properties
user=net.jforum.view.forum.UserAction 2.2 查询action 根据请求的url中的 edit`在相应的UserAction中找到edit方法：
/jforum/src/net/jforum/view/forum/UserAction.java
public void edit() { if (this.canEdit()) { int userId = this.request.getIntParameter(&#34;user_id&#34;); UserDAO um = DataAccessDriver.getInstance().newUserDAO(); User u = um.selectById(userId); this.context.put(&#34;u&#34;, u); this.context.put(&#34;action&#34;, &#34;editSave&#34;); this.context.put(&#34;pageTitle&#34;, I18n.getMessage(&#34;UserProfile.profileFor&#34;) + &#34; &#34; +u.getUsername()); this.context.put(&#34;avatarAllowExternalUrl&#34;, SystemGlobals.getBoolValue(ConfigKeys.AVATAR_ALLOW_EXTERNAL_URL)); this.setTemplateName(TemplateKeys.USER_EDIT); } } 2."><link rel=stylesheet href=/css/styles.pcss integrity=><script>localStorage.theme==='dark'||!('theme'in localStorage)&&window.matchMedia('(prefers-color-scheme: dark)').matches?document.documentElement.classList.add('dark'):document.documentElement.classList.remove('dark')</script></head><body class="flex flex-col items-center w-full"><main class="w-full sm:w-10/12 md:w-9/12 lg:w-7/12 xl:w-5/12 m-auto px-6"><header class="mt-9 mb-8"><div class="flex justify-between items-center"><div class="flex items-center"><input id=navbar_btn class=hidden type=checkbox>
<label for=navbar_btn class="menu-btn mr-4 items-center flex xl:hidden"><span class=navicon></span></label><a href=/ class="font-bold text-lg xl:text-2xl mr-auto">My New Hugo Site</a></div><div class="flex items-center"><div class="cursor-pointer ml-2"><svg id="dark_mode_btn" class="hidden" width="18" height="18" viewBox="0 0 24 24"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69zM12 18c-3.31.0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"/></svg></svg><svg id="light_mode_btn" class="hidden" width="18" height="18" viewBox="0 0 24 24"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><g><path d="M0 0h24v24H0V0z" fill="none"/></g><g><g><g><path d="M14 2c1.82.0 3.53.5 5 1.35C16.01 5.08 14 8.3 14 12s2.01 6.92 5 8.65C17.53 21.5 15.82 22 14 22 8.48 22 4 17.52 4 12S8.48 2 14 2z"/></g></g></g></svg></svg></div></div></div><nav id=navbar class="mt-3 hidden xl:block"><ul class=flex></ul></nav><nav id=navbar_sm class="mt-2 hidden"><ul></ul><hr class=my-4></nav></header><div id=content class=my-8><div class="collapsible-menu-wrapper my-8 p-4 border-2 rounded"><div class="flex justify-between"><span class=font-bold>Table of contents</span></div><div class="collapsible-menu text-sm ml-2"><div class=leading-6><nav id=TableOfContents><ul><li><a href=#jforum二次开发相关笔记>jforum二次开发相关笔记</a><ul><li><a href=#1-引言>1. 引言</a></li><li><a href=#2-jforum的页面请求机制>2. jforum的页面请求机制</a></li><li><a href=#3-参考资料>3. 参考资料</a></li></ul></li></ul></nav></div></div></div><div class=my-7><article><p>[TOC]</p><h2 id=jforum二次开发相关笔记>jforum二次开发相关笔记</h2><h3 id=1-引言>1. 引言</h3><p><a href=http://jforum.net>jforum</a>是Rafael Steil开发的一个基于JAVA的开源论坛，采用BSD开源协议，可以最大限度的进行任何修改和扩展，包括商业用途。它提供了诸如SSO之类的抽象接口，具有完全的权限控制、支持包括中文在内的十几种语言、可自定义的用户接口、安全、多数据库支持等特性。JForum 采用 FreeMarker作为页面模板引擎。jforum的介绍这里不再敷述，因项目需要，需要对jforum进行修改、实现从CS平台登录以后单点登录到jforum，因为jforum只支持唯一用户名标识，所以还需对jforum进行二次开发。(注：本文的jforum版本为2.1.9。)</p><h3 id=2-jforum的页面请求机制>2. jforum的页面请求机制</h3><p>将jforum导入到eclipse可以参考《<a href=http://www.jiacode.com/739.html>Java开源论坛JForum二次开发技术资料之导入安装</a>》。以最简单的在一个登陆用户进入 <code>个人资料</code>页为例：</p><p><img src=images/26173549_bKYN.png alt=jforum导航栏></p><h4 id=21-处理url>2.1 处理url</h4><p>用户点击 <code>个人资料</code>，页面请求的url为/user/edit/session中获取的用户Id如header.htm源码所示：
<code>/jforum/WebContent/templates/default/header.htm</code></p><pre><code class=language-jsp data-lang=jsp>&lt;a id=&quot;myprofile&quot; class=&quot;mainmenu&quot; href=&quot;${JForumContext.encodeURL(&quot;/user/edit/${session.userId}&quot;)}&quot;&gt;
&lt;img src=&quot;${contextPath}/templates/${templateName}/images/icon_mini_profile.gif&quot; border=&quot;0&quot; alt=&quot;[Profile]&quot; /&gt;
${I18n.getMessage(&quot;ForumBase.profile&quot;)}
</code></pre><p>JForum中的JForumContext.encodeURL方法（注：实现在/jforum/src/net/jforum/context/JForumContext.java下）根据请求的url中的 user<code>和 edit</code>在modulesMapping.properties中查询user对应的配置项:</p><p><code>/jforum/WebContent/WEB-INF/config/modulesMapping.properties</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>user<span style=color:#f92672>=</span>net<span style=color:#f92672>.</span><span style=color:#a6e22e>jforum</span><span style=color:#f92672>.</span><span style=color:#a6e22e>view</span><span style=color:#f92672>.</span><span style=color:#a6e22e>forum</span><span style=color:#f92672>.</span><span style=color:#a6e22e>UserAction</span>
</code></pre></div><h4 id=22-查询action>2.2 查询action</h4><p>根据请求的url中的 edit`在相应的UserAction中找到edit方法：</p><p><code>/jforum/src/net/jforum/view/forum/UserAction.java</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>edit</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
	<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>canEdit</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
		<span style=color:#66d9ef>int</span> userId <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>request</span><span style=color:#f92672>.</span><span style=color:#a6e22e>getIntParameter</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;user_id&#34;</span><span style=color:#f92672>);</span>
		UserDAO um <span style=color:#f92672>=</span> DataAccessDriver<span style=color:#f92672>.</span><span style=color:#a6e22e>getInstance</span><span style=color:#f92672>().</span><span style=color:#a6e22e>newUserDAO</span><span style=color:#f92672>();</span>
		User u <span style=color:#f92672>=</span> um<span style=color:#f92672>.</span><span style=color:#a6e22e>selectById</span><span style=color:#f92672>(</span>userId<span style=color:#f92672>);</span>
		<span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>context</span><span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;u&#34;</span><span style=color:#f92672>,</span> u<span style=color:#f92672>);</span>
		<span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>context</span><span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;action&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;editSave&#34;</span><span style=color:#f92672>);</span>
		<span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>context</span><span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;pageTitle&#34;</span><span style=color:#f92672>,</span> I18n<span style=color:#f92672>.</span><span style=color:#a6e22e>getMessage</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;UserProfile.profileFor&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; &#34;</span> <span style=color:#f92672>+</span>u<span style=color:#f92672>.</span><span style=color:#a6e22e>getUsername</span><span style=color:#f92672>());</span>
		<span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>context</span><span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;avatarAllowExternalUrl&#34;</span><span style=color:#f92672>,</span> SystemGlobals<span style=color:#f92672>.</span><span style=color:#a6e22e>getBoolValue</span><span style=color:#f92672>(</span>ConfigKeys<span style=color:#f92672>.</span><span style=color:#a6e22e>AVATAR_ALLOW_EXTERNAL_URL</span><span style=color:#f92672>));</span>
		<span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>setTemplateName</span><span style=color:#f92672>(</span>TemplateKeys<span style=color:#f92672>.</span><span style=color:#a6e22e>USER_EDIT</span><span style=color:#f92672>);</span>
	<span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><h4 id=23-查询dao层>2.3 查询dao层</h4><p>根据action中的 um.selectById(userId)`请求UserDAO文件中的selectById方法：</p><p><code>/jforum/src/net/jforum/dao/UserDAO.java</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#75715e>/**
</span><span style=color:#75715e>* Gets a specific &lt;code&gt;User&lt;/code&gt;.
</span><span style=color:#75715e>*
</span><span style=color:#75715e>* @param userId The User ID to search
</span><span style=color:#75715e>* @return &lt;code&gt;User&lt;/code&gt;object containing all the information
</span><span style=color:#75715e>* @see #selectAll
</span><span style=color:#75715e>*/</span>
<span style=color:#66d9ef>public</span> User <span style=color:#a6e22e>selectById</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> userId<span style=color:#f92672>)</span> <span style=color:#f92672>;</span>
</code></pre></div><p>UserDAO只是一个抽象的DAO接口，GenericUserDAO具体实现了UserDAO中定义的方法：</p><p><code>/jforum/src/net/jforum/dao/generic/GenericUserDAO.java</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#75715e>/**
</span><span style=color:#75715e>* @see net.jforum.dao.UserDAO#selectById(int)
</span><span style=color:#75715e>*/</span>
<span style=color:#66d9ef>public</span> User <span style=color:#a6e22e>selectById</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> userId<span style=color:#f92672>)</span>
<span style=color:#f92672>{</span>
	String q <span style=color:#f92672>=</span> SystemGlobals<span style=color:#f92672>.</span><span style=color:#a6e22e>getSql</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;UserModel.selectById&#34;</span><span style=color:#f92672>);</span>
	PreparedStatement p <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
	ResultSet rs <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
	<span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
		p <span style=color:#f92672>=</span> JForumExecutionContext<span style=color:#f92672>.</span><span style=color:#a6e22e>getConnection</span><span style=color:#f92672>().</span><span style=color:#a6e22e>prepareStatement</span><span style=color:#f92672>(</span>q<span style=color:#f92672>);</span>
		p<span style=color:#f92672>.</span><span style=color:#a6e22e>setInt</span><span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> userId<span style=color:#f92672>);</span>
		rs <span style=color:#f92672>=</span> p<span style=color:#f92672>.</span><span style=color:#a6e22e>executeQuery</span><span style=color:#f92672>();</span>
		User u <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> User<span style=color:#f92672>();</span>
		<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>rs<span style=color:#f92672>.</span><span style=color:#a6e22e>next</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
			<span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>fillUserFromResultSet</span><span style=color:#f92672>(</span>u<span style=color:#f92672>,</span> rs<span style=color:#f92672>);</span>
			u<span style=color:#f92672>.</span><span style=color:#a6e22e>setPrivateMessagesCount</span><span style=color:#f92672>(</span>rs<span style=color:#f92672>.</span><span style=color:#a6e22e>getInt</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;private_messages&#34;</span><span style=color:#f92672>));</span>
			rs<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
			p<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
			<span style=color:#75715e>// User groups
</span><span style=color:#75715e></span>			p <span style=color:#f92672>=</span> JForumExecutionContext<span style=color:#f92672>.</span><span style=color:#a6e22e>getConnection</span><span style=color:#f92672>().</span><span style=color:#a6e22e>prepareStatement</span><span style=color:#f92672>(</span>SystemGlobals<span style=color:#f92672>.</span><span style=color:#a6e22e>getSql</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;UserModelselectGroups&#34;</span><span style=color:#f92672>));</span>
			p<span style=color:#f92672>.</span><span style=color:#a6e22e>setInt</span><span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> userId<span style=color:#f92672>);</span>
			rs <span style=color:#f92672>=</span> p<span style=color:#f92672>.</span><span style=color:#a6e22e>executeQuery</span><span style=color:#f92672>();</span>
			<span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>rs<span style=color:#f92672>.</span><span style=color:#a6e22e>next</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
				Group g <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Group<span style=color:#f92672>();</span>
				g<span style=color:#f92672>.</span><span style=color:#a6e22e>setName</span><span style=color:#f92672>(</span>rs<span style=color:#f92672>.</span><span style=color:#a6e22e>getString</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;group_name&#34;</span><span style=color:#f92672>));</span>
				g<span style=color:#f92672>.</span><span style=color:#a6e22e>setId</span><span style=color:#f92672>(</span>rs<span style=color:#f92672>.</span><span style=color:#a6e22e>getInt</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;group_id&#34;</span><span style=color:#f92672>));</span>
				u<span style=color:#f92672>.</span><span style=color:#a6e22e>getGroupsList</span><span style=color:#f92672>().</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>g<span style=color:#f92672>);</span>
			<span style=color:#f92672>}</span>
		<span style=color:#f92672>}</span>
		<span style=color:#66d9ef>return</span> u<span style=color:#f92672>;</span>
	<span style=color:#f92672>}</span>
	<span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>SQLException e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
		<span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> DatabaseException<span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
	<span style=color:#f92672>}</span>
	<span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
		DbUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>(</span>rs<span style=color:#f92672>,</span> p<span style=color:#f92672>);</span>
	<span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><h4 id=24-查询sql>2.4 查询sql</h4><p>根据GenericUserDAO文件中的 UserModel.selectById`查询sql文件中相应的sql：</p><p><code>/jforum/WebContent/WEB-INF/config/database/generic/generic_queries.sql</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>UserModel.selectById <span style=color:#f92672>=</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>COUNT</span>(pm.privmsgs_to_userid) <span style=color:#66d9ef>AS</span> private_messages, u.<span style=color:#f92672>*</span> <span style=color:#960050;background-color:#1e0010>\</span>
<span style=color:#66d9ef>FROM</span> jforum_users u <span style=color:#960050;background-color:#1e0010>\</span>
<span style=color:#66d9ef>LEFT</span> <span style=color:#66d9ef>JOIN</span> jforum_privmsgs pm <span style=color:#66d9ef>ON</span> pm.privmsgs_type <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>AND</span> pm.privmsgs_to_userid <span style=color:#f92672>=</span> u.user_id <span style=color:#960050;background-color:#1e0010>\</span>
<span style=color:#66d9ef>WHERE</span> u.user_id <span style=color:#f92672>=</span> <span style=color:#f92672>?</span> <span style=color:#960050;background-color:#1e0010>\</span>
<span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> pm.privmsgs_to_userid
</code></pre></div><h4 id=25-返回结果到页面>2.5 返回结果到页面</h4><p>根据 <code>templatesMapping</code>中的配置找到user.edit对应的页面
<code>/jforum/WebContent/WEB-INF/config/templatesMapping.properties</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>user<span style=color:#f92672>.</span><span style=color:#a6e22e>edit</span> <span style=color:#f92672>=</span> user_form<span style=color:#f92672>.</span><span style=color:#a6e22e>htm</span>
</code></pre></div><h4 id=26-打印页面>2.6 打印页面</h4><p>在页面中填入查询到的值：</p><p><code>/jforum/WebContent/templates/default/user_form.htm</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;gen&#34;</span>&gt;
<span style=color:#960050;background-color:#1e0010>&lt;</span>#if admin?default(false)&gt;
&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;post&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;username&#34;</span>  <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;${u.username?html}&#34;</span> /&gt;
<span style=color:#960050;background-color:#1e0010>&lt;</span>#else&gt;
${u.username?html}
<span style=color:#960050;background-color:#1e0010>&lt;</span>/#if&gt;
&lt;/<span style=color:#f92672>span</span>&gt;
</code></pre></div><p>用户的实体类在 <code>/jforum/src/net/jforum/entities/User.java</code> 下。
个人资料页如下图所示:</p><p><img src=images/26173855_trF9.png alt=jforum个人资料页></p><h3 id=3-参考资料>3. 参考资料</h3><ul><li><a href=http://www.jiacode.com/739.html>Java开源论坛JForum二次开发技术资料之导入安装</a></li></ul></article></div></div></main><script src=/js/header.0b11855b871cb4d10c6c07b6723b9209f5c2bc9100735ab6ff47c8f9b76bb3d6ae41b488083b5fb15697987334039eb651b25c83228c29ac48a2bc168db8a894.js integrity="sha512-CxGFW4cctNEMbAe2cjuSCfXCvJEAc1q2/0fI+bdrs9auQbSICDtfsVaXmHM0A562UbJcgyKMKaxIorwWjbiolA=="></script><script src=/js/zooming.js integrity></script><script src=/js/code-copy-btn.js integrity></script></body></html>