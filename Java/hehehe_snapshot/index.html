<!doctype html><html class="h-full w-full font-sans" lang=zh-cn><head><meta charset=utf-8><link rel="shortcut icon" href=http://example.org/favicon.ico type=image/x-icon><meta name=viewport content="width=device-width,initial-scale=1"><title>- My New Hugo Site</title><meta property="og:title" content><meta property="og:description" content="[TOC]
 一切都源于这个表情，后面这个表情就以不可预料的情况演化了。那时想着做一个能加苍蝇的截图工具，程序是用JAVA实现的，项目托管在GitHub https://github.com/Bigcaitou/HEHEHEScreenshot
    Talk is cheap, show you the code.    截取屏幕 public RectD() { snapshot(); setVisible(true); // setSize(d);//最大化窗口  //用 JDialog 做一个无控制条的窗口，大小设置成满屏，把截取的这个满屏的图片贴到这个 JDiaglog 里  setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); this.addMouseListener(new MouseAdapter() {// 得到鼠标箭头初始坐标  @Override public void mousePressed(MouseEvent e) { orgx = e.getX(); orgy = e.getY(); } }); //鼠标圈定区域， 对圈定的区域截屏  this.addMouseMotionListener(new MouseMotionAdapter() { @Override public void mouseDragged(MouseEvent e) { endx = e.getX(); endy = e."><meta property="og:type" content="article"><meta property="og:url" content="http://example.org/java/hehehe_snapshot/"><meta property="article:section" content="Java"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="[TOC]
 一切都源于这个表情，后面这个表情就以不可预料的情况演化了。那时想着做一个能加苍蝇的截图工具，程序是用JAVA实现的，项目托管在GitHub https://github.com/Bigcaitou/HEHEHEScreenshot
    Talk is cheap, show you the code.    截取屏幕 public RectD() { snapshot(); setVisible(true); // setSize(d);//最大化窗口  //用 JDialog 做一个无控制条的窗口，大小设置成满屏，把截取的这个满屏的图片贴到这个 JDiaglog 里  setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); this.addMouseListener(new MouseAdapter() {// 得到鼠标箭头初始坐标  @Override public void mousePressed(MouseEvent e) { orgx = e.getX(); orgy = e.getY(); } }); //鼠标圈定区域， 对圈定的区域截屏  this.addMouseMotionListener(new MouseMotionAdapter() { @Override public void mouseDragged(MouseEvent e) { endx = e.getX(); endy = e."><link rel=stylesheet href=/css/styles.pcss integrity=><script>localStorage.theme==='dark'||!('theme'in localStorage)&&window.matchMedia('(prefers-color-scheme: dark)').matches?document.documentElement.classList.add('dark'):document.documentElement.classList.remove('dark')</script></head><body class="flex flex-col items-center w-full"><main class="w-full sm:w-10/12 md:w-9/12 lg:w-7/12 xl:w-5/12 m-auto px-6"><header class="mt-9 mb-8"><div class="flex justify-between items-center"><div class="flex items-center"><input id=navbar_btn class=hidden type=checkbox>
<label for=navbar_btn class="menu-btn mr-4 items-center flex xl:hidden"><span class=navicon></span></label><a href=/ class="font-bold text-lg xl:text-2xl mr-auto">My New Hugo Site</a></div><div class="flex items-center"><div class="cursor-pointer ml-2"><svg id="dark_mode_btn" class="hidden" width="18" height="18" viewBox="0 0 24 24"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69zM12 18c-3.31.0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"/></svg></svg><svg id="light_mode_btn" class="hidden" width="18" height="18" viewBox="0 0 24 24"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><g><path d="M0 0h24v24H0V0z" fill="none"/></g><g><g><g><path d="M14 2c1.82.0 3.53.5 5 1.35C16.01 5.08 14 8.3 14 12s2.01 6.92 5 8.65C17.53 21.5 15.82 22 14 22 8.48 22 4 17.52 4 12S8.48 2 14 2z"/></g></g></g></svg></svg></div></div></div><nav id=navbar class="mt-3 hidden xl:block"><ul class=flex></ul></nav><nav id=navbar_sm class="mt-2 hidden"><ul></ul><hr class=my-4></nav></header><div id=content class=my-8><div class="collapsible-menu-wrapper my-8 p-4 border-2 rounded"><div class="flex justify-between"><span class=font-bold>Table of contents</span></div><div class="collapsible-menu text-sm ml-2"><div class=leading-6><nav id=TableOfContents><ul><li><a href=#截取屏幕>截取屏幕</a></li><li><a href=#添加苍蝇>添加苍蝇</a></li><li><a href=#截图复制到剪贴板>截图复制到剪贴板</a></li><li><a href=#系统托盘>系统托盘</a></li><li><a href=#保存图片>保存图片</a></li><li><a href=#相关链接>相关链接</a></li></ul></nav></div></div></div><div class=my-7><article><p>[TOC]</p><blockquote><p>一切都源于这个表情，后面这个表情就以不可预料的情况演化了。那时想着做一个能加苍蝇的截图工具，程序是用JAVA实现的，项目托管在GitHub <a href=https://github.com/Bigcaitou/HEHEHEScreenshot>https://github.com/Bigcaitou/HEHEHEScreenshot</a></p></blockquote><p><img src=images/10104625_kRAQ.jpg alt=苍蝇表情></p><table><thead><tr><th style=text-align:center><strong>Talk is cheap, show you the code.</strong></th></tr></thead></table><h2 id=截取屏幕>截取屏幕</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JAVA data-lang=JAVA><span style=color:#66d9ef>public</span> <span style=color:#a6e22e>RectD</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
    snapshot<span style=color:#f92672>();</span>
    setVisible<span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
    <span style=color:#75715e>// setSize(d);//最大化窗口
</span><span style=color:#75715e></span>        <span style=color:#75715e>//用 JDialog 做一个无控制条的窗口，大小设置成满屏，把截取的这个满屏的图片贴到这个 JDiaglog 里
</span><span style=color:#75715e></span>    setDefaultCloseOperation<span style=color:#f92672>(</span>JFrame<span style=color:#f92672>.</span><span style=color:#a6e22e>EXIT_ON_CLOSE</span><span style=color:#f92672>);</span>
    <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>addMouseListener</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> MouseAdapter<span style=color:#f92672>()</span> <span style=color:#f92672>{</span><span style=color:#75715e>// 得到鼠标箭头初始坐标
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>@Override</span>
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>mousePressed</span><span style=color:#f92672>(</span>MouseEvent e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            orgx <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>getX</span><span style=color:#f92672>();</span>
            orgy <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>getY</span><span style=color:#f92672>();</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>});</span>
    <span style=color:#75715e>//鼠标圈定区域， 对圈定的区域截屏
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>addMouseMotionListener</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> MouseMotionAdapter<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        <span style=color:#a6e22e>@Override</span>
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>mouseDragged</span><span style=color:#f92672>(</span>MouseEvent e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            endx <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>getX</span><span style=color:#f92672>();</span>
            endy <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>getY</span><span style=color:#f92672>();</span>
            g <span style=color:#f92672>=</span> getGraphics<span style=color:#f92672>();</span>
            g<span style=color:#f92672>.</span><span style=color:#a6e22e>drawImage</span><span style=color:#f92672>(</span>tempImage<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> RectD<span style=color:#f92672>.</span><span style=color:#a6e22e>this</span><span style=color:#f92672>);</span>
            <span style=color:#66d9ef>int</span> x <span style=color:#f92672>=</span> Math<span style=color:#f92672>.</span><span style=color:#a6e22e>min</span><span style=color:#f92672>(</span>orgx<span style=color:#f92672>,</span> endx<span style=color:#f92672>);</span>
            <span style=color:#66d9ef>int</span> y <span style=color:#f92672>=</span> Math<span style=color:#f92672>.</span><span style=color:#a6e22e>min</span><span style=color:#f92672>(</span>orgy<span style=color:#f92672>,</span> endy<span style=color:#f92672>);</span>
            <span style=color:#66d9ef>int</span> width <span style=color:#f92672>=</span> Math<span style=color:#f92672>.</span><span style=color:#a6e22e>abs</span><span style=color:#f92672>(</span>endx <span style=color:#f92672>-</span> orgx<span style=color:#f92672>)</span> <span style=color:#f92672>+</span> 1<span style=color:#f92672>;</span>
            <span style=color:#66d9ef>int</span> height <span style=color:#f92672>=</span> Math<span style=color:#f92672>.</span><span style=color:#a6e22e>abs</span><span style=color:#f92672>(</span>endy <span style=color:#f92672>-</span> orgy<span style=color:#f92672>)</span> <span style=color:#f92672>+</span> 1<span style=color:#f92672>;</span>
            <span style=color:#75715e>// 加上1，防止width或height为0
</span><span style=color:#75715e></span>            g<span style=color:#f92672>.</span><span style=color:#a6e22e>setColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>BLUE</span><span style=color:#f92672>);</span>
            g<span style=color:#f92672>.</span><span style=color:#a6e22e>drawRect</span><span style=color:#f92672>(</span>x <span style=color:#f92672>-</span> 1<span style=color:#f92672>,</span> y <span style=color:#f92672>-</span> 1<span style=color:#f92672>,</span> width <span style=color:#f92672>+</span> 1<span style=color:#f92672>,</span> height <span style=color:#f92672>+</span> 1<span style=color:#f92672>);</span>
            <span style=color:#75715e>// 减1，加1都是为了防止图片将矩形框覆盖掉
</span><span style=color:#75715e></span>            saveImage <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getSubimage</span><span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>,</span> width<span style=color:#f92672>,</span> height<span style=color:#f92672>);</span>
            g<span style=color:#f92672>.</span><span style=color:#a6e22e>drawImage</span><span style=color:#f92672>(</span>saveImage<span style=color:#f92672>,</span> x<span style=color:#f92672>,</span> y<span style=color:#f92672>,</span> RectD<span style=color:#f92672>.</span><span style=color:#a6e22e>this</span><span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>});</span>
    <span style=color:#75715e>//双击鼠标截图
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>addMouseListener</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> MouseAdapter<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        <span style=color:#a6e22e>@Override</span>
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>mousePressed</span><span style=color:#f92672>(</span>MouseEvent e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>int</span> clickTimes <span style=color:#f92672>=</span> e<span style=color:#f92672>.</span><span style=color:#a6e22e>getClickCount</span><span style=color:#f92672>();</span>
            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>clickTimes <span style=color:#f92672>==</span> 2<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
                saveToFile<span style=color:#f92672>();</span>
            <span style=color:#f92672>}</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>});</span>
<span style=color:#f92672>}</span>
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JAVA data-lang=JAVA><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>snapshot</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
        Robot robot <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Robot<span style=color:#f92672>();</span>
        Dimension d <span style=color:#f92672>=</span> Toolkit<span style=color:#f92672>.</span><span style=color:#a6e22e>getDefaultToolkit</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getScreenSize</span><span style=color:#f92672>();</span>
        image <span style=color:#f92672>=</span> robot<span style=color:#f92672>.</span><span style=color:#a6e22e>createScreenCapture</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> Rectangle<span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> d<span style=color:#f92672>.</span><span style=color:#a6e22e>width</span><span style=color:#f92672>,</span> d<span style=color:#f92672>.</span><span style=color:#a6e22e>height</span><span style=color:#f92672>));</span>
    <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>AWTException e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        e<span style=color:#f92672>.</span><span style=color:#a6e22e>printStackTrace</span><span style=color:#f92672>();</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>利用Robot的createScreenCapture可以截图，但是有个问题是遇到多个屏幕，这个方法只能在默认屏幕截图。</p><h2 id=添加苍蝇>添加苍蝇</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JAVA data-lang=JAVA><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>markImageByIcon</span><span style=color:#f92672>(</span>String iconPath<span style=color:#f92672>,</span> String srcImgPath<span style=color:#f92672>,</span> String targerPath<span style=color:#f92672>,</span> Integer degree<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
    OutputStream os <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
    <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
        Image srcImg <span style=color:#f92672>=</span> ImageIO<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> File<span style=color:#f92672>(</span>srcImgPath<span style=color:#f92672>));</span>
        BufferedImage buffImg <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BufferedImage<span style=color:#f92672>(</span>srcImg<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>),</span> srcImg<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>),</span>
                BufferedImage<span style=color:#f92672>.</span><span style=color:#a6e22e>TYPE_INT_RGB</span><span style=color:#f92672>);</span>
        <span style=color:#75715e>// 得到画笔对象
</span><span style=color:#75715e></span>        Graphics2D g <span style=color:#f92672>=</span> buffImg<span style=color:#f92672>.</span><span style=color:#a6e22e>createGraphics</span><span style=color:#f92672>();</span>
        <span style=color:#75715e>// 设置对线段的锯齿状边缘处理
</span><span style=color:#75715e></span>        g<span style=color:#f92672>.</span><span style=color:#a6e22e>setRenderingHint</span><span style=color:#f92672>(</span>RenderingHints<span style=color:#f92672>.</span><span style=color:#a6e22e>KEY_INTERPOLATION</span><span style=color:#f92672>,</span> RenderingHints<span style=color:#f92672>.</span><span style=color:#a6e22e>VALUE_INTERPOLATION_BILINEAR</span><span style=color:#f92672>);</span>
        g<span style=color:#f92672>.</span><span style=color:#a6e22e>drawImage</span><span style=color:#f92672>(</span>srcImg<span style=color:#f92672>.</span><span style=color:#a6e22e>getScaledInstance</span><span style=color:#f92672>(</span>srcImg<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>),</span> srcImg<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>),</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>SCALE_SMOOTH</span><span style=color:#f92672>),</span> 0<span style=color:#f92672>,</span>
                0<span style=color:#f92672>,</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>null</span> <span style=color:#f92672>!=</span> degree<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#75715e>// 设置水印旋转
</span><span style=color:#75715e></span>            g<span style=color:#f92672>.</span><span style=color:#a6e22e>rotate</span><span style=color:#f92672>(</span>Math<span style=color:#f92672>.</span><span style=color:#a6e22e>toRadians</span><span style=color:#f92672>(</span>degree<span style=color:#f92672>),</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>double</span><span style=color:#f92672>)</span> buffImg<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>()</span> <span style=color:#f92672>/</span> 2<span style=color:#f92672>,</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>double</span><span style=color:#f92672>)</span> buffImg<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>()</span> <span style=color:#f92672>/</span> 2<span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>
        <span style=color:#75715e>// 水印图象的路径 水印一般为gif或者png的，这样可设置透明度
</span><span style=color:#75715e></span>        ImageIcon imgIcon <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ImageIcon<span style=color:#f92672>(</span>iconPath<span style=color:#f92672>);</span>
        <span style=color:#75715e>// ImageIcon imgIcon = new ImageIcon(iconPath);
</span><span style=color:#75715e></span>        <span style=color:#75715e>// 得到Image对象。
</span><span style=color:#75715e></span>        Image img <span style=color:#f92672>=</span> imgIcon<span style=color:#f92672>.</span><span style=color:#a6e22e>getImage</span><span style=color:#f92672>();</span>
        <span style=color:#66d9ef>float</span> alpha <span style=color:#f92672>=</span> 1f<span style=color:#f92672>;</span>
        <span style=color:#75715e>// 透明度
</span><span style=color:#75715e></span>        g<span style=color:#f92672>.</span><span style=color:#a6e22e>setComposite</span><span style=color:#f92672>(</span>AlphaComposite<span style=color:#f92672>.</span><span style=color:#a6e22e>getInstance</span><span style=color:#f92672>(</span>AlphaComposite<span style=color:#f92672>.</span><span style=color:#a6e22e>SRC_ATOP</span><span style=color:#f92672>,</span> alpha<span style=color:#f92672>));</span>
        <span style=color:#75715e>// 表示水印图片的位置
</span><span style=color:#75715e></span>        g<span style=color:#f92672>.</span><span style=color:#a6e22e>drawImage</span><span style=color:#f92672>(</span>img<span style=color:#f92672>,</span> 50<span style=color:#f92672>,</span> 50<span style=color:#f92672>,</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
        g<span style=color:#f92672>.</span><span style=color:#a6e22e>setComposite</span><span style=color:#f92672>(</span>AlphaComposite<span style=color:#f92672>.</span><span style=color:#a6e22e>getInstance</span><span style=color:#f92672>(</span>AlphaComposite<span style=color:#f92672>.</span><span style=color:#a6e22e>SRC_OVER</span><span style=color:#f92672>));</span>
        g<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
        os <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FileOutputStream<span style=color:#f92672>(</span>targerPath<span style=color:#f92672>);</span>
        <span style=color:#75715e>// 生成图片
</span><span style=color:#75715e></span>        ImageIO<span style=color:#f92672>.</span><span style=color:#a6e22e>write</span><span style=color:#f92672>(</span>buffImg<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;PNG&#34;</span><span style=color:#f92672>,</span> os<span style=color:#f92672>);</span>
        setClipboardImage<span style=color:#f92672>(</span>buffImg<span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        e<span style=color:#f92672>.</span><span style=color:#a6e22e>printStackTrace</span><span style=color:#f92672>();</span>
    <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>null</span> <span style=color:#f92672>!=</span> os<span style=color:#f92672>)</span>
                os<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
        <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            e<span style=color:#f92672>.</span><span style=color:#a6e22e>printStackTrace</span><span style=color:#f92672>();</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>苍蝇的大小要合适，太大的话太假，太小的话素材太难抠了，最后苍蝇素材是从一个苍蝇画刷工具而来的，我还找了会PS的同学帮我画上苍蝇腿。</p><h2 id=截图复制到剪贴板>截图复制到剪贴板</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JAVA data-lang=JAVA><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setClipboardImage</span><span style=color:#f92672>(</span><span style=color:#66d9ef>final</span> Image image<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
    Transferable trans <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Transferable<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>public</span> DataFlavor<span style=color:#f92672>[]</span> <span style=color:#a6e22e>getTransferDataFlavors</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> DataFlavor<span style=color:#f92672>[]</span> <span style=color:#f92672>{</span> DataFlavor<span style=color:#f92672>.</span><span style=color:#a6e22e>imageFlavor</span> <span style=color:#f92672>};</span>
        <span style=color:#f92672>}</span>
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>isDataFlavorSupported</span><span style=color:#f92672>(</span>DataFlavor flavor<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>return</span> DataFlavor<span style=color:#f92672>.</span><span style=color:#a6e22e>imageFlavor</span><span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>flavor<span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>
        <span style=color:#66d9ef>public</span> Object <span style=color:#a6e22e>getTransferData</span><span style=color:#f92672>(</span>DataFlavor flavor<span style=color:#f92672>)</span> <span style=color:#66d9ef>throws</span> UnsupportedFlavorException<span style=color:#f92672>,</span> IOException <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>isDataFlavorSupported<span style=color:#f92672>(</span>flavor<span style=color:#f92672>))</span>
                <span style=color:#66d9ef>return</span> image<span style=color:#f92672>;</span>
            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> UnsupportedFlavorException<span style=color:#f92672>(</span>flavor<span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>};</span>
    Toolkit<span style=color:#f92672>.</span><span style=color:#a6e22e>getDefaultToolkit</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getSystemClipboard</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setContents</span><span style=color:#f92672>(</span>trans<span style=color:#f92672>,</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
<span style=color:#f92672>}</span>
</code></pre></div><h2 id=系统托盘>系统托盘</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JAVA data-lang=JAVA><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SystemTrayDemo</span> <span style=color:#66d9ef>extends</span> JFrame <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>long</span> serialVersionUID <span style=color:#f92672>=</span> 1L<span style=color:#f92672>;</span>
    <span style=color:#66d9ef>private</span> TrayIcon trayIcon <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>SystemTrayDemo</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>SystemTray<span style=color:#f92672>.</span><span style=color:#a6e22e>isSupported</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
            <span style=color:#75715e>// 检查当前系统是否支持系统托盘
</span><span style=color:#75715e></span>            SystemTray tray <span style=color:#f92672>=</span> SystemTray<span style=color:#f92672>.</span><span style=color:#a6e22e>getSystemTray</span><span style=color:#f92672>();</span>
            <span style=color:#75715e>// 获取表示桌面托盘区的SystemTray实例。
</span><span style=color:#75715e></span>            Image image <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>getToolkit</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getImage</span><span style=color:#f92672>(</span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>getClass</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getResource</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/image/logo.png&#34;</span><span style=color:#f92672>));</span>
            PopupMenu popupMenu <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PopupMenu<span style=color:#f92672>();</span>
            MenuItem exitItem <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> MenuItem<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;退出&#34;</span><span style=color:#f92672>);</span>
            MenuItem menuItema <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> MenuItem<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;截图&#34;</span><span style=color:#f92672>);</span>
            exitItem<span style=color:#f92672>.</span><span style=color:#a6e22e>addActionListener</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> ActionListener<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
                <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>actionPerformed</span><span style=color:#f92672>(</span>ActionEvent e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
                    <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
                        System<span style=color:#f92672>.</span><span style=color:#a6e22e>exit</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
                    <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception ex<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
                        ex<span style=color:#f92672>.</span><span style=color:#a6e22e>printStackTrace</span><span style=color:#f92672>();</span>
                    <span style=color:#f92672>}</span>
                <span style=color:#f92672>}</span>
            <span style=color:#f92672>});</span>
            popupMenu<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>menuItema<span style=color:#f92672>);</span>
            popupMenu<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>exitItem<span style=color:#f92672>);</span>
            trayIcon <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TrayIcon<span style=color:#f92672>(</span>image<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;呵呵呵截图&#34;</span><span style=color:#f92672>,</span> popupMenu<span style=color:#f92672>);</span>
            <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>flag<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
                flag <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
                menuItema<span style=color:#f92672>.</span><span style=color:#a6e22e>addActionListener</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> ActionListener<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
                    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>actionPerformed</span><span style=color:#f92672>(</span>ActionEvent e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
                        <span style=color:#75715e>// 这里调用截图功能
</span><span style=color:#75715e></span>                        RectD rd <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> RectD<span style=color:#f92672>();</span>
                        GraphicsDevice gd <span style=color:#f92672>=</span> GraphicsEnvironment<span style=color:#f92672>.</span><span style=color:#a6e22e>getLocalGraphicsEnvironment</span><span style=color:#f92672>()</span>
                                <span style=color:#f92672>.</span><span style=color:#a6e22e>getDefaultScreenDevice</span><span style=color:#f92672>();</span>
                        gd<span style=color:#f92672>.</span><span style=color:#a6e22e>setFullScreenWindow</span><span style=color:#f92672>(</span>rd<span style=color:#f92672>);</span>
                    <span style=color:#f92672>}</span>
                <span style=color:#f92672>});</span>
                <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
                    tray<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>trayIcon<span style=color:#f92672>);</span>
                    <span style=color:#75715e>// 将 TrayIcon 添加到 SystemTray。
</span><span style=color:#75715e></span>                <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>AWTException e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
                    System<span style=color:#f92672>.</span><span style=color:#a6e22e>err</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
                <span style=color:#f92672>}</span>
            <span style=color:#f92672>}</span>
        <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;你的系统不支持系统托盘&#34;</span><span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>
        <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
        <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>可能会遇到托盘乱码，可以参考 <a href=http://blog.csdn.net/lishaman/article/details/17751727>《java软件托盘MenuItem 显示中文出现框框乱码、读取ini配置文件乱码》</a> ，来解决问题。</p><h2 id=保存图片>保存图片</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JAVA data-lang=JAVA><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>saveToFile</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
    SimpleDateFormat sdf <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SimpleDateFormat<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;yyyy年MM月dd日HH时mm分ss秒&#34;</span><span style=color:#f92672>);</span>
    String name <span style=color:#f92672>=</span> sdf<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> Date<span style=color:#f92672>());</span>
    File path <span style=color:#f92672>=</span> FileSystemView<span style=color:#f92672>.</span><span style=color:#a6e22e>getFileSystemView</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getHomeDirectory</span><span style=color:#f92672>();</span>
    <span style=color:#75715e>// 图片保存在桌面
</span><span style=color:#75715e></span>    String format <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;png&#34;</span><span style=color:#f92672>;</span>
    File f <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> File<span style=color:#f92672>(</span>path <span style=color:#f92672>+</span> File<span style=color:#f92672>.</span><span style=color:#a6e22e>separator</span> <span style=color:#f92672>+</span> name <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.&#34;</span> <span style=color:#f92672>+</span> format<span style=color:#f92672>);</span>
    <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
        ImageIO<span style=color:#f92672>.</span><span style=color:#a6e22e>write</span><span style=color:#f92672>(</span>saveImage<span style=color:#f92672>,</span> format<span style=color:#f92672>,</span> f<span style=color:#f92672>);</span>
        String srcImgPath <span style=color:#f92672>=</span> path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\&#34;</span> <span style=color:#f92672>+</span> name <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.png&#34;</span><span style=color:#f92672>;</span>
        String iconPath <span style=color:#f92672>=</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>getProperty</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;user.dir&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\1.png&#34;</span><span style=color:#f92672>;</span>
        <span style=color:#75715e>// URL iconPath = this.getClass().getResource(&#34;/image/1.png&#34;);
</span><span style=color:#75715e></span>        String targerPath <span style=color:#f92672>=</span> path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\&#34;</span> <span style=color:#f92672>+</span> name <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;呵呵呵.png&#34;</span><span style=color:#f92672>;</span>
        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
            <span style=color:#75715e>//给图片添加水印
</span><span style=color:#75715e></span>        HEHEHEScreenshot<span style=color:#f92672>.</span><span style=color:#a6e22e>markImageByIcon</span><span style=color:#f92672>(</span>iconPath<span style=color:#f92672>,</span> srcImgPath<span style=color:#f92672>,</span> targerPath<span style=color:#f92672>,</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>IOException e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        e<span style=color:#f92672>.</span><span style=color:#a6e22e>printStackTrace</span><span style=color:#f92672>();</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>效果图如下所示：</p><p><img src=images/10104658_oAsF.png alt=HEHEHE></p><h2 id=相关链接>相关链接</h2><table><thead><tr><th style=text-align:center>相关链接</th></tr></thead><tbody><tr><td style=text-align:center><a href=https://mega.nz/#!bF4HSaSQ!wFtq9vbUzrqvTI6Xe0WJcZg0YZIVg4HINNQEZ3MmTOE>苍蝇画刷工具下载</a></td></tr><tr><td style=text-align:center><a href=https://github.com/Bigcaitou/HEHEHEScreenshot>项目主页</a></td></tr><tr><td style=text-align:center><a href=http://www.cnblogs.com/superjt/archive/2012/12/19/2824426.html>java 截图源码</a></td></tr><tr><td style=text-align:center><a href=http://www.2cto.com/kf/201108/101021.html>Java实现给图片添加水印</a></td></tr><tr><td style=text-align:center><a href=http://blog.csdn.net/lishaman/article/details/17751727>java软件托盘MenuItem 显示中文出现框框乱码、读取ini配置文件乱码</a></td></tr></tbody></table><p>下次再讲</p><blockquote><ul><li>jar的运行</li><li>jar→exe</li><li>jre精简</li><li>跨平台优化</li></ul></blockquote><p>为什么要叫HEHEHEScreenshot呢，因为之前我注册过一个域名：hehehe.xyz，然后就在谷歌成立母公司Alphabet并注册域名abc.xyz之后，我才想起我的hehehe.xyz忘记续费了，结果被别人抢注了哭，本来一个很有意思的域名，呵呵呵，我现在只能翻出来之前写的用来调戏处女座的截图工具，来纪念我的hehehe.xyz</p></article></div></div></main><script src=/js/header.0b11855b871cb4d10c6c07b6723b9209f5c2bc9100735ab6ff47c8f9b76bb3d6ae41b488083b5fb15697987334039eb651b25c83228c29ac48a2bc168db8a894.js integrity="sha512-CxGFW4cctNEMbAe2cjuSCfXCvJEAc1q2/0fI+bdrs9auQbSICDtfsVaXmHM0A562UbJcgyKMKaxIorwWjbiolA=="></script><script src=/js/zooming.js integrity></script><script src=/js/code-copy-btn.js integrity></script></body></html>